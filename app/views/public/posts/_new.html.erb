<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8">
      
      <h3>投稿</h3>
      
      <%= form_with model: @post_new, url: posts_path, method: :post do |form| %>
      
       <div class="row">
        <div class="col-md-4 mt-5">
          <div class="d-flex justify-content-center flex-column align-items-center">
            <%= image_tag "noimage.jpg", class: "img-fluid rounded mb-3", id: "preview-image" if @user.posts.any? %>
            <div style="color:red">※'png''jpg'画像のみ</div>
            <%= form.file_field :post_image, accept: "image/*", id: "post_image" %>
          </div>
        </div>

          

          <div class="col-md-8">
            
            <div class="row">
              <div class="col-md-12">
                <p>
                  <div style="color:red">※'png''jpg'画像のみ</div>
                  <%= form.label :post_images, "投稿画像 (最大4枚)" %>
                  <%= form.file_field :post_images, multiple: true, accept: "image/*" %>
                </p>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-6"> 
                <p>
                  <label class="form-label"></label>
                  <%= form.collection_select :genre_id, Genre.all, :id, :name, { prompt: "選択してください" }, { class: "form-control" } %>
                </p>
              </div>
              <div class="col-md-6"> 
                <p>
                  <label for="title" class="form-label"></label>
                  <%= form.text_field :title, id: "title", placeholder: "Title", class: "form-control" %> 
                </p>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-12">
                <p>
                  <label for="content" class="form-label"></label>
                  <%= form.text_area :content, rows: 2, id: "content", placeholder: "Content", class: "form-control", rows: 4, cols: 50 %>
                </p>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-12 mt-1">
                <%= form.submit "投稿", class: "button" %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
      
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    var input = document.getElementById('post_image');
    var preview = document.getElementById('preview-image');

    input.addEventListener('change', function() {
      var file = this.files[0];
      var reader = new FileReader();

      reader.onload = function(e) {
        preview.src = e.target.result;
      };

      reader.readAsDataURL(file);
    });
  });
</script>
